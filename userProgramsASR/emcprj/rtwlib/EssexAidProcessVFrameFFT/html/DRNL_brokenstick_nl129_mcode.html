<pre class="code">
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',253);">253</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',254);">254</a></span><span class="line"><span class="comment">%nick modified broken stick function</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',255);">255</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S75T4U929">x</span>] = DRNL_brokenstick_nl (<span class="mxinfo" id="T4:U2"><span class="mxinfo" id="T4:U3"><span class="var type1" id="S75T4U932">x</span></span></span>, <span class="mxinfo" id="T6:U5"><span class="mxinfo" id="T6:U6"><span class="var type1" id="S76T6U933">a</span></span></span>, <span class="var type1" id="S77T6U934">b</span>, <span class="var type1" id="S78T6U935">c</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',256);">256</a></span><span class="line"><span class="comment">% y = sign(x).* min(a*abs_x,  b*abs_x .^ c);</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',257);">257</a></span><span class="line"><span class="comment">% This function could be replaced by a lookup table</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',258);">258</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',259);">259</a></span><span class="line"><span class="mxinfo" id="T4:U10"><span class="var type1" id="S79T4U938">abs_x</span> = <span class="mxinfo" id="T4:U12">abs(<span class="var type1" id="S75T4U941">x</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',260);">260</a></span><span class="line"><span class="comment">% linear (low amplitude) response</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',261);">261</a></span><span class="line"><span class="mxinfo" id="T4:U14"><span class="var type1" id="S75T4U944">x</span>=<span class="mxinfo" id="T4:U16"><span class="mxinfo" id="T6:U17"><span class="var type1" id="S76T6U946">a</span></span>*<span class="var type1" id="S75T4U947">x</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',262);">262</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',263);">263</a></span><span class="line"><span class="comment">% compressed high amplitude</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',264);">264</a></span><span class="line"><span class="mxinfo" id="T6:U20"><span class="var type1" id="S81T6U950">compressionThreshold</span>=<span class="mxinfo" id="T6:U22"><span class="mxinfo" id="T6:U23">10</span>.^(<span class="mxinfo" id="T6:U24">(<span class="mxinfo" id="T6:U25"><span class="mxinfo" id="T6:U26">1</span>/(<span class="mxinfo" id="T6:U27"><span class="mxinfo" id="T6:U28">1</span>-<span class="var type1" id="S78T6U961">c</span></span>)</span>).*<span class="mxinfo" id="T6:U30">log10(<span class="mxinfo" id="T6:U31"><span class="var type1" id="S77T6U965">b</span>/<span class="mxinfo" id="T6:U33"><span class="var type1" id="S76T6U966">a</span></span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',265);">265</a></span><span class="line"><span class="comment">% only values outside the compression threshold</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',266);">266</a></span><span class="line"><span class="comment">%  need be subject to compression</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',267);">267</a></span><span class="line"><span class="mxinfo" id="T26:U35"><span class="var type1" id="S83T26U969">idx</span>=<span class="mxinfo" id="T26:U37">find(<span class="mxinfo" id="T24:U38"><span class="var type1" id="S79T4U973">abs_x</span>&gt;<span class="var type1" id="S81T6U974">compressionThreshold</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',268);">268</a></span><span class="line"><span class="mxinfo" id="T26:U41"><span class="mxinfo" id="T26:U42"><span class="var type1" id="S75T4U978">x</span>(<span class="var type1" id="S83T26U979">idx</span>)</span> = <span class="mxinfo" id="T26:U45"><span class="mxinfo" id="T26:U46">sign(<span class="mxinfo" id="T26:U47"><span class="var type1" id="S75T4U984">x</span>(<span class="var type1" id="S83T26U985">idx</span>)</span>)</span>.* ( <span class="mxinfo" id="T26:U50"><span class="var type1" id="S77T6U988">b</span>*<span class="mxinfo" id="T26:U52"><span class="mxinfo" id="T26:U53"><span class="var type1" id="S79T4U991">abs_x</span>(<span class="var type1" id="S83T26U992">idx</span>)</span> .^ <span class="var type1" id="S78T6U993">c</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',269);">269</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',270);">270</a></span><span class="line"><span class="keyword">end</span> <span class="comment">%of DRNL_brokenstick_nl</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',271);">271</a></span><span class="line"></span></span>
</pre>
