<pre class="code">
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',249);">249</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',250);">250</a></span><span class="line"><span class="comment">%nick modified broken stick function</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',251);">251</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S74T8U905">x</span>] = DRNL_brokenstick_nl (<span class="mxinfo" id="T8:U2"><span class="mxinfo" id="T8:U3"><span class="var type1" id="S74T8U908">x</span></span></span>, <span class="mxinfo" id="T6:U5"><span class="mxinfo" id="T6:U6"><span class="var type1" id="S75T6U909">a</span></span></span>, <span class="var type1" id="S76T6U910">b</span>, <span class="var type1" id="S77T6U911">c</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',252);">252</a></span><span class="line"><span class="comment">% y = sign(x).* min(a*abs_x,  b*abs_x .^ c);</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',253);">253</a></span><span class="line"><span class="comment">% This function could be replaced by a lookup table</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',254);">254</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',255);">255</a></span><span class="line"><span class="mxinfo" id="T8:U10"><span class="var type1" id="S78T8U914">abs_x</span> = <span class="mxinfo" id="T8:U12">abs(<span class="var type1" id="S74T8U917">x</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',256);">256</a></span><span class="line"><span class="comment">% linear (low amplitude) response</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',257);">257</a></span><span class="line"><span class="mxinfo" id="T8:U14"><span class="var type1" id="S74T8U920">x</span>=<span class="mxinfo" id="T8:U16"><span class="var type1" id="S75T6U922">a</span>*<span class="var type1" id="S74T8U923">x</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',258);">258</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',259);">259</a></span><span class="line"><span class="comment">% compressed high amplitude</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',260);">260</a></span><span class="line"><span class="mxinfo" id="T6:U19"><span class="var type1" id="S80T6U926">compressionThreshold</span>=<span class="mxinfo" id="T6:U21"><span class="mxinfo" id="T6:U22">10</span>.^(<span class="mxinfo" id="T6:U23">(<span class="mxinfo" id="T6:U24"><span class="mxinfo" id="T6:U25">1</span>/(<span class="mxinfo" id="T6:U26"><span class="mxinfo" id="T6:U27">1</span>-<span class="var type1" id="S77T6U937">c</span></span>)</span>).*<span class="mxinfo" id="T6:U29">log10(<span class="mxinfo" id="T6:U30"><span class="var type1" id="S76T6U941">b</span>/<span class="mxinfo" id="T6:U32"><span class="var type1" id="S75T6U942">a</span></span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',261);">261</a></span><span class="line"><span class="comment">% only values outside the compression threshold</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',262);">262</a></span><span class="line"><span class="comment">%  need be subject to compression</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',263);">263</a></span><span class="line"><span class="mxinfo" id="T8:U34"><span class="var type1" id="S82T8U945">idx</span>=<span class="mxinfo" id="T8:U36">find(<span class="mxinfo" id="T23:U37"><span class="var type1" id="S78T8U949">abs_x</span>&gt;<span class="var type1" id="S80T6U950">compressionThreshold</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',264);">264</a></span><span class="line"><span class="mxinfo" id="T8:U40"><span class="mxinfo" id="T8:U41"><span class="var type1" id="S74T8U954">x</span>(<span class="var type1" id="S82T8U955">idx</span>)</span> = <span class="mxinfo" id="T8:U44"><span class="mxinfo" id="T8:U45">sign(<span class="mxinfo" id="T8:U46"><span class="var type1" id="S74T8U960">x</span>(<span class="var type1" id="S82T8U961">idx</span>)</span>)</span>.* ( <span class="mxinfo" id="T8:U49"><span class="var type1" id="S76T6U964">b</span>*<span class="mxinfo" id="T8:U51"><span class="mxinfo" id="T8:U52"><span class="var type1" id="S78T8U967">abs_x</span>(<span class="var type1" id="S82T8U968">idx</span>)</span> .^ <span class="var type1" id="S77T6U969">c</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',265);">265</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',266);">266</a></span><span class="line"><span class="keyword">end</span> <span class="comment">%of DRNL_brokenstick_nl</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',267);">267</a></span><span class="line"></span></span>
</pre>
