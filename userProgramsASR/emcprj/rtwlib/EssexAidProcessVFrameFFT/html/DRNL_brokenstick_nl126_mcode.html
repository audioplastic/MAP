<pre class="code">
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',255);">255</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',256);">256</a></span><span class="line"><span class="comment">%nick modified broken stick function</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',257);">257</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S75T42U947">x</span>] = DRNL_brokenstick_nl (<span class="mxinfo" id="T42:U2"><span class="mxinfo" id="T42:U3"><span class="var type1" id="S75T42U950">x</span></span></span>, <span class="mxinfo" id="T6:U5"><span class="mxinfo" id="T6:U6"><span class="var type1" id="S76T6U951">a</span></span></span>, <span class="var type1" id="S77T6U952">b</span>, <span class="var type1" id="S78T6U953">c</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',258);">258</a></span><span class="line"><span class="comment">% y = sign(x).* min(a*abs_x,  b*abs_x .^ c);</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',259);">259</a></span><span class="line"><span class="comment">% This function could be replaced by a lookup table</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',260);">260</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',261);">261</a></span><span class="line"><span class="mxinfo" id="T42:U10"><span class="var type1" id="S79T42U956">abs_x</span> = <span class="mxinfo" id="T42:U12">abs(<span class="var type1" id="S75T42U959">x</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',262);">262</a></span><span class="line"><span class="comment">% linear (low amplitude) response</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',263);">263</a></span><span class="line"><span class="mxinfo" id="T42:U14"><span class="var type1" id="S75T42U962">x</span>=<span class="mxinfo" id="T42:U16"><span class="var type1" id="S76T6U964">a</span>*<span class="var type1" id="S75T42U965">x</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',264);">264</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',265);">265</a></span><span class="line"><span class="comment">% compressed high amplitude</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',266);">266</a></span><span class="line"><span class="mxinfo" id="T6:U19"><span class="var type1" id="S81T6U968">compressionThreshold</span>=<span class="mxinfo" id="T6:U21"><span class="mxinfo" id="T6:U22">10</span>.^(<span class="mxinfo" id="T6:U23">(<span class="mxinfo" id="T6:U24"><span class="mxinfo" id="T6:U25">1</span>/(<span class="mxinfo" id="T6:U26"><span class="mxinfo" id="T6:U27">1</span>-<span class="var type1" id="S78T6U979">c</span></span>)</span>).*<span class="mxinfo" id="T6:U29">log10(<span class="mxinfo" id="T6:U30"><span class="var type1" id="S77T6U983">b</span>/<span class="mxinfo" id="T6:U32"><span class="var type1" id="S76T6U984">a</span></span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',267);">267</a></span><span class="line"><span class="comment">% only values outside the compression threshold</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',268);">268</a></span><span class="line"><span class="comment">%  need be subject to compression</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',269);">269</a></span><span class="line"><span class="mxinfo" id="T42:U34"><span class="var type1" id="S83T42U987">idx</span>=<span class="mxinfo" id="T42:U36">find(<span class="mxinfo" id="T45:U37"><span class="var type1" id="S79T42U991">abs_x</span>&gt;<span class="var type1" id="S81T6U992">compressionThreshold</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',270);">270</a></span><span class="line"><span class="mxinfo" id="T42:U40"><span class="mxinfo" id="T42:U41"><span class="var type1" id="S75T42U996">x</span>(<span class="var type1" id="S83T42U997">idx</span>)</span> = <span class="mxinfo" id="T42:U44">sign(<span class="mxinfo" id="T42:U45"><span class="var type1" id="S75T42U1002">x</span>(<span class="var type1" id="S83T42U1003">idx</span>)</span>)</span>.* ( <span class="mxinfo" id="T42:U48"><span class="var type1" id="S77T6U1006">b</span>*<span class="mxinfo" id="T43:U50"><span class="mxinfo" id="T42:U51"><span class="var type1" id="S79T42U1009">abs_x</span>(<span class="var type1" id="S83T42U1010">idx</span>)</span> .^ <span class="var type1" id="S78T6U1011">c</span></span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',271);">271</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',272);">272</a></span><span class="line"><span class="keyword">end</span> <span class="comment">%of DRNL_brokenstick_nl</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',273);">273</a></span><span class="line"></span></span>
</pre>
