<pre class="code">
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',255);">255</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',256);">256</a></span><span class="line"><span class="comment">%nick modified broken stick function</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',257);">257</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S76T43U951">x</span>] = DRNL_brokenstick_nl (<span class="mxinfo" id="T43:U2"><span class="mxinfo" id="T43:U3"><span class="var type1" id="S76T43U954">x</span></span></span>, <span class="mxinfo" id="T6:U5"><span class="mxinfo" id="T6:U6"><span class="var type1" id="S77T6U955">a</span></span></span>, <span class="var type1" id="S78T6U956">b</span>, <span class="var type1" id="S79T6U957">c</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',258);">258</a></span><span class="line"><span class="comment">% y = sign(x).* min(a*abs_x,  b*abs_x .^ c);</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',259);">259</a></span><span class="line"><span class="comment">% This function could be replaced by a lookup table</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',260);">260</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',261);">261</a></span><span class="line"><span class="mxinfo" id="T43:U10"><span class="var type1" id="S80T43U960">abs_x</span> = <span class="mxinfo" id="T43:U12">abs(<span class="var type1" id="S76T43U963">x</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',262);">262</a></span><span class="line"><span class="comment">% linear (low amplitude) response</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',263);">263</a></span><span class="line"><span class="mxinfo" id="T43:U14"><span class="var type1" id="S76T43U966">x</span>=<span class="mxinfo" id="T43:U16"><span class="var type1" id="S77T6U968">a</span>*<span class="var type1" id="S76T43U969">x</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',264);">264</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',265);">265</a></span><span class="line"><span class="comment">% compressed high amplitude</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',266);">266</a></span><span class="line"><span class="mxinfo" id="T6:U19"><span class="var type1" id="S82T6U972">compressionThreshold</span>=<span class="mxinfo" id="T6:U21"><span class="mxinfo" id="T6:U22">10</span>.^(<span class="mxinfo" id="T6:U23">(<span class="mxinfo" id="T6:U24"><span class="mxinfo" id="T6:U25">1</span>/(<span class="mxinfo" id="T6:U26"><span class="mxinfo" id="T6:U27">1</span>-<span class="var type1" id="S79T6U983">c</span></span>)</span>).*<span class="mxinfo" id="T6:U29">log10(<span class="mxinfo" id="T6:U30"><span class="var type1" id="S78T6U987">b</span>/<span class="mxinfo" id="T6:U32"><span class="var type1" id="S77T6U988">a</span></span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',267);">267</a></span><span class="line"><span class="comment">% only values outside the compression threshold</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',268);">268</a></span><span class="line"><span class="comment">%  need be subject to compression</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',269);">269</a></span><span class="line"><span class="mxinfo" id="T43:U34"><span class="var type1" id="S84T43U991">idx</span>=<span class="mxinfo" id="T43:U36">find(<span class="mxinfo" id="T46:U37"><span class="var type1" id="S80T43U995">abs_x</span>&gt;<span class="var type1" id="S82T6U996">compressionThreshold</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',270);">270</a></span><span class="line"><span class="mxinfo" id="T43:U40"><span class="mxinfo" id="T43:U41"><span class="var type1" id="S76T43U1000">x</span>(<span class="var type1" id="S84T43U1001">idx</span>)</span> = <span class="mxinfo" id="T43:U44">sign(<span class="mxinfo" id="T43:U45"><span class="var type1" id="S76T43U1006">x</span>(<span class="var type1" id="S84T43U1007">idx</span>)</span>)</span>.* ( <span class="mxinfo" id="T43:U48"><span class="var type1" id="S78T6U1010">b</span>*<span class="mxinfo" id="T44:U50"><span class="mxinfo" id="T43:U51"><span class="var type1" id="S80T43U1013">abs_x</span>(<span class="var type1" id="S84T43U1014">idx</span>)</span> .^ <span class="var type1" id="S79T6U1015">c</span></span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',271);">271</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',272);">272</a></span><span class="line"><span class="keyword">end</span> <span class="comment">%of DRNL_brokenstick_nl</span></span></span>
<span class="srcline"><span class="lineno"><a href="matlab: emlcprivate('irOpenToLine','C:/Users/nrclark/programming/MAP/userProgramsASR/EssexAidProcessVFrameFFT.m',273);">273</a></span><span class="line"></span></span>
</pre>
